<!DOCTYPE html>
<html>
<head>
    <title>GMKB Diagnostic Check</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1e1e1e; color: #d4d4d4; }
        .check { margin: 10px 0; padding: 10px; border-left: 4px solid #666; }
        .pass { border-color: #4caf50; background: #1a3a1a; }
        .fail { border-color: #f44336; background: #3a1a1a; }
        .warn { border-color: #ff9800; background: #3a2a1a; }
        pre { background: #2a2a2a; padding: 10px; overflow-x: auto; }
        h2 { color: #4fc3f7; }
    </style>
</head>
<body>
    <h1>üîç GMKB Diagnostic Check</h1>
    <p>Run this BEFORE loading the media kit builder page</p>
    
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        function addCheck(title, status, details) {
            const div = document.createElement('div');
            div.className = `check ${status}`;
            div.innerHTML = `
                <strong>${status === 'pass' ? '‚úÖ' : status === 'fail' ? '‚ùå' : '‚ö†Ô∏è'} ${title}</strong>
                ${details ? `<pre>${details}</pre>` : ''}
            `;
            results.appendChild(div);
        }
        
        // Check 1: window.gmkbData exists
        if (typeof window.gmkbData !== 'undefined') {
            addCheck('window.gmkbData exists', 'pass', JSON.stringify(Object.keys(window.gmkbData), null, 2));
        } else {
            addCheck('window.gmkbData exists', 'fail', 'window.gmkbData is undefined! PHP injection failed.');
        }
        
        // Check 2: apiSettings exists
        if (window.gmkbData?.apiSettings) {
            addCheck('apiSettings exists', 'pass', JSON.stringify(window.gmkbData.apiSettings, null, 2));
        } else {
            addCheck('apiSettings exists', 'fail', 'apiSettings is missing from gmkbData');
        }
        
        // Check 3: apiSettings.xss exists
        if (window.gmkbData?.apiSettings?.xss) {
            addCheck('apiSettings.xss exists', 'pass', JSON.stringify(window.gmkbData.apiSettings.xss, null, 2));
        } else {
            addCheck('apiSettings.xss exists', 'fail', 'xss config is missing');
        }
        
        // Check 4: deprecationConfig exists
        if (window.gmkbData?.deprecationConfig !== undefined) {
            addCheck('deprecationConfig exists', 'pass', JSON.stringify(window.gmkbData.deprecationConfig, null, 2));
        } else {
            addCheck('deprecationConfig exists', 'fail', 'deprecationConfig is missing');
        }
        
        // Check 5: componentRegistry
        if (window.gmkbData?.componentRegistry) {
            const count = Object.keys(window.gmkbData.componentRegistry).length;
            addCheck('componentRegistry exists', count > 0 ? 'pass' : 'warn', `${count} components registered`);
        } else {
            addCheck('componentRegistry exists', 'fail', 'componentRegistry is missing');
        }
        
        // Check 6: Show ALL gmkbData keys
        if (window.gmkbData) {
            addCheck('All gmkbData keys', 'pass', Object.keys(window.gmkbData).join(', '));
        }
        
        // Check 7: Check dist file timestamp
        addCheck('Next Step', 'warn', 'If any checks failed, you need to:\n1. Run: npm run build\n2. Hard refresh browser (Ctrl+Shift+R)\n3. Run this diagnostic again');
    </script>
</body>
</html>
