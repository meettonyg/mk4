<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theme Customizer - Streamlined Preview</title>
    <!--
    THEME CUSTOMIZER - DESIGN PHILOSOPHY
    
    This customizer provides ESSENTIAL theme settings only (~16 total).
    Individual components can be styled separately, so this focuses on:
    
    ✓ GLOBAL BRAND IDENTITY (colors, typography)
    ✓ LAYOUT FOUNDATION (spacing, container)
    ✓ VISUAL POLISH (borders, shadows)
    
    WHAT'S INCLUDED:
    - Colors (8): Primary + text, secondary, backgrounds, text, links
    - Typography (4): Fonts, sizing scale
    - Spacing (2): Base unit, container width
    - Effects (2): Border radius, shadow intensity
    
    WHAT'S EXCLUDED (component-level or auto-generated):
    - Status colors (dev responsibility, accessibility)
    - Border colors (auto-generated from surface)
    - Secondary text colors (auto-generated with opacity)
    - Line height, font weight (component-specific)
    - Animation speeds (system-level)
    - Granular spacing (scales from base unit)
    
    GOAL: 2-minute brand setup, not 20-minute detail tweaking.
    -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1.5rem;
        }

        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal {
            background: white;
            border-radius: 12px;
            width: 95%;
            max-width: 1400px;
            height: 90vh;
            max-height: 900px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Header */
        .modal-header {
            padding: 1.25rem 1.75rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .unsaved-badge {
            font-size: 0.8rem;
            color: #f59e0b;
            font-weight: 500;
        }

        .close-btn {
            background: transparent;
            border: none;
            color: #6b7280;
            font-size: 1.5rem;
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: #f3f4f6;
            color: #1f2937;
        }

        /* Body */
        .modal-body {
            display: grid;
            grid-template-columns: 1fr 540px;
            flex: 1;
            overflow: hidden;
        }

        /* Preview Section */
        .preview-section {
            background: #f9fafb;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            overflow-x: hidden;
            border-right: 1px solid #e5e7eb;
            min-height: 0; /* Important for flex scrolling */
        }

        .preview-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 1.5rem;
        }

        .preview-frame {
            background: white;
            border-radius: 8px;
            padding: 3rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            flex: 1;
        }

        /* Typography Preview */
        .preview-frame h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 1rem;
        }

        .preview-frame h2 {
            font-size: 2rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.75rem;
        }

        .preview-frame h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #4b5563;
            margin-bottom: 0.75rem;
        }

        .preview-frame .lead {
            font-size: 1.25rem;
            line-height: 1.6;
            color: #4b5563;
            margin-bottom: 1rem;
        }

        .preview-frame p {
            font-size: 1rem;
            line-height: 1.6;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        .preview-frame .small {
            font-size: 0.875rem;
            color: #9ca3af;
        }

        /* Component Preview */
        .components-preview {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #e5e7eb;
        }

        .preview-section-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 1rem;
        }

        .button-group {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .preview-btn {
            padding: 0.625rem 1.25rem;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .preview-btn-primary {
            background: #3b82f6;
            color: white;
        }

        .preview-btn-secondary {
            background: #6b7280;
            color: white;
        }

        .preview-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .preview-card h4 {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .preview-card p {
            font-size: 0.875rem;
            color: #64748b;
            margin: 0;
        }



        /* Settings Section */
        .settings-section {
            display: flex;
            flex-direction: column;
            background: white;
            min-height: 0; /* Important for flex scrolling */
            overflow: visible; /* ROOT FIX: Allow content to be visible and scrollable */
        }

        .tabs-container {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
            padding: 0;
            background: #fafafa;
            overflow-x: auto; /* ROOT FIX: Allow horizontal scroll if needed */
            overflow-y: hidden;
            flex-wrap: nowrap;
            flex-shrink: 0; /* Prevent tabs from shrinking */
            /* Add smooth scrolling for tabs */
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }

        .tab {
            padding: 0.75rem 1rem; /* ROOT FIX: Increased horizontal padding */
            background: transparent;
            border: none;
            cursor: pointer;
            font-weight: 500;
            color: #6b7280;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem; /* ROOT FIX: Slightly larger font */
            white-space: nowrap;
            flex: 0 0 auto; /* ROOT FIX: Don't shrink, natural width */
            min-width: fit-content; /* ROOT FIX: Ensure tabs fit their content */
        }

        .tab:hover {
            color: #374151;
            background: rgba(0, 0, 0, 0.02);
        }

        .tab.active {
            color: #3b82f6;
            border-bottom-color: #3b82f6;
            background: white;
        }

        .tab-content {
            flex: 1 1 auto; /* ROOT FIX: Allow growing and shrinking */
            overflow-y: auto; /* Vertical scroll */
            overflow-x: hidden; /* No horizontal scroll */
            padding: 1.5rem;
            min-height: 0; /* Important for flex scrolling */
            height: 0; /* ROOT FIX: Force height calculation from flex */
            position: relative;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        .section-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .section-description {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 2rem;
        }

        .section {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #f3f4f6;
        }

        .section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .section h4 {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        .setting-group {
            margin-bottom: 1.5rem;
        }

        .setting-group:last-child {
            margin-bottom: 0;
        }

        .setting-label {
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
            display: block;
            font-size: 0.875rem;
        }

        .setting-description {
            font-size: 0.8rem;
            color: #9ca3af;
            margin-top: 0.375rem;
        }

        .setting-control {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .color-input {
            width: 50px;
            height: 38px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            cursor: pointer;
        }

        .text-input {
            flex: 1;
            padding: 0.625rem 0.875rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.875rem;
            transition: border-color 0.2s;
        }

        .text-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .range-input {
            flex: 1;
        }

        .range-value {
            min-width: 55px;
            text-align: center;
            font-weight: 600;
            color: #3b82f6;
            font-size: 0.875rem;
        }

        .select-input {
            width: 100%;
            padding: 0.625rem 0.875rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.875rem;
            background: white;
            cursor: pointer;
            transition: border-color 0.2s;
        }

        .select-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* Footer */
        .modal-footer {
            padding: 1.25rem 1.75rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fafafa;
        }

        .footer-left {
            display: flex;
            gap: 0.75rem;
        }

        .footer-right {
            display: flex;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.625rem 1.25rem;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .btn-reset {
            background: white;
            color: #374151;
            border: 1px solid #d1d5db;
        }

        .btn-reset:hover {
            background: #f9fafb;
            border-color: #9ca3af;
        }

        .btn-cancel {
            background: white;
            color: #374151;
            border: 1px solid #d1d5db;
        }

        .btn-cancel:hover {
            background: #f9fafb;
        }

        .btn-apply {
            background: #3b82f6;
            color: white;
        }

        .btn-apply:hover {
            background: #2563eb;
        }

        /* Scrollbar Styling - ROOT FIX: More prominent and visible */
        ::-webkit-scrollbar {
            width: 14px; /* Wider for better visibility */
            height: 14px;
        }

        ::-webkit-scrollbar-track {
            background: #e5e7eb; /* More visible track */
            border-left: 1px solid #d1d5db;
        }

        ::-webkit-scrollbar-thumb {
            background: #6b7280; /* Darker, more visible thumb */
            border-radius: 7px;
            border: 3px solid #e5e7eb;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #4b5563; /* Even darker on hover */
        }

        ::-webkit-scrollbar-thumb:active {
            background: #374151; /* Darkest when active */
        }

        /* Firefox Scrollbar */
        * {
            scrollbar-width: auto;
            scrollbar-color: #6b7280 #e5e7eb; /* Match WebKit colors */
        }

        /* ROOT FIX: Add visible scroll indicator when scrollable */
        .tab-content.has-scroll::before {
            content: '';
            position: sticky;
            top: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(to bottom, white, transparent);
            pointer-events: none;
            z-index: 1;
        }

        .tab-content.has-scroll::after {
            content: '';
            position: sticky;
            bottom: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(to top, white, transparent);
            pointer-events: none;
            z-index: 1;
        }

        /* ROOT FIX: Scroll indicators for preview section */
        .preview-section.has-scroll::after {
            content: '';
            position: sticky;
            bottom: 0;
            left: 0;
            right: 0;
            height: 30px;
            background: linear-gradient(to top, rgba(249, 250, 251, 1), rgba(249, 250, 251, 0));
            pointer-events: none;
            z-index: 1;
        }

        @media (max-width: 1200px) {
            .modal-body {
                grid-template-columns: 1fr 480px;
            }
        }

        @media (max-width: 1024px) {
            .modal-body {
                grid-template-columns: 1fr;
                grid-template-rows: 300px 1fr;
            }
            
            .preview-section {
                border-right: none;
                border-bottom: 1px solid #e5e7eb;
            }
        }
    </style>
</head>
<body>
    <div class="modal-overlay">
        <div class="modal">
            <!-- Header -->
            <div class="modal-header">
                <h2 class="modal-title">Theme Customizer</h2>
                <div class="header-actions">
                    <span class="unsaved-badge">• Unsaved changes</span>
                    <button class="close-btn" onclick="closeModal()">✕</button>
                </div>
            </div>

            <!-- Body -->
            <div class="modal-body">
                <!-- Preview Section -->
                <div class="preview-section">
                    <div class="preview-label">Live Preview</div>
                    <div class="preview-frame" id="previewFrame">
                        <!-- Typography -->
                        <h1 id="previewH1">Heading Level 1</h1>
                        <h2 id="previewH2">Heading Level 2</h2>
                        <h3 id="previewH3">Heading Level 3</h3>
                        <p class="lead" id="previewLead">
                            This is a lead paragraph with slightly larger text to make it stand out from regular body text.
                        </p>
                        <p id="previewBody">
                            This is regular body text. Lorem ipsum dolor sit amet, consectetur adipiscing elit. 
                            Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                            <a href="#" id="previewLink" style="color: #3b82f6; text-decoration: none; font-weight: 500;">Learn more about styling options</a>.
                        </p>
                        <p class="small" id="previewSmall">
                            This is small text, typically used for captions or secondary information.
                        </p>

                        <!-- Components -->
                        <div class="components-preview">
                            <div class="preview-section-title">Components</div>
                            
                            <!-- Buttons -->
                            <div class="button-group">
                                <button class="preview-btn preview-btn-primary" id="primaryBtn">
                                    Primary Button
                                </button>
                                <button class="preview-btn preview-btn-secondary" id="secondaryBtn">
                                    Secondary Button
                                </button>
                            </div>

                            <!-- Card -->
                            <div class="preview-card" id="previewCard">
                                <h4>Card Component</h4>
                                <p>Cards use surface color with borders and subtle shadows for depth.</p>
                            </div>


                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div class="settings-section">
                    <div class="tabs-container">
                        <button class="tab" onclick="switchTab(0)">
                            <span>Themes</span>
                        </button>
                        <button class="tab active" onclick="switchTab(1)">
                            <span>Colors</span>
                        </button>
                        <button class="tab" onclick="switchTab(2)">
                            <span>Typography</span>
                        </button>
                        <button class="tab" onclick="switchTab(3)">
                            <span>Spacing</span>
                        </button>
                        <button class="tab" onclick="switchTab(4)">
                            <span>Effects</span>
                        </button>
                    </div>

                    <div class="tab-content">
                        <!-- Themes Tab -->
                        <div class="tab-pane">
                            <h3 class="section-title">Theme Presets</h3>
                            <p class="section-description">Quick start with pre-designed themes</p>
                            <p style="color: #6b7280;">Theme presets will be implemented in the Vue component</p>
                        </div>

                        <!-- Colors Tab -->
                        <div class="tab-pane active">
                            <h3 class="section-title">Color Customization</h3>
                            <p class="section-description">Customize your theme colors</p>

                            <div class="section">
                                <h4>Primary Colors</h4>
                                <div class="setting-group">
                                    <label class="setting-label">Primary Color</label>
                                    <div class="setting-control">
                                        <input type="color" class="color-input" id="primaryColorPicker" value="#3b82f6" onchange="updatePrimaryColor(this.value)">
                                        <input type="text" class="text-input" id="primaryColorText" value="#3b82f6" oninput="updateFromTextInput('primaryColorPicker', this.value, updatePrimaryColor)">
                                    </div>
                                    <p class="setting-description">Brand color for buttons and accents</p>
                                </div>
                                <div class="setting-group">
                                    <label class="setting-label">Primary Text Color</label>
                                    <div class="setting-control">
                                        <input type="color" class="color-input" id="primaryTextPicker" value="#ffffff" onchange="updatePrimaryTextColor(this.value)">
                                        <input type="text" class="text-input" id="primaryTextText" value="#ffffff" oninput="updateFromTextInput('primaryTextPicker', this.value, updatePrimaryTextColor)">
                                    </div>
                                    <p class="setting-description">Text color on primary buttons (ensure good contrast)</p>
                                </div>
                                <div class="setting-group">
                                    <label class="setting-label">Secondary Color</label>
                                    <div class="setting-control">
                                        <input type="color" class="color-input" id="secondaryColorPicker" value="#6b7280" onchange="updateSecondaryColor(this.value)">
                                        <input type="text" class="text-input" id="secondaryColorText" value="#6b7280" oninput="updateFromTextInput('secondaryColorPicker', this.value, updateSecondaryColor)">
                                    </div>
                                    <p class="setting-description">Accent color for secondary actions</p>
                                </div>
                            </div>

                            <div class="section">
                                <h4>Background</h4>
                                <div class="setting-group">
                                    <label class="setting-label">Page Background</label>
                                    <div class="setting-control">
                                        <input type="color" class="color-input" id="bgColorPicker" value="#ffffff" onchange="updateBackgroundColor(this.value)">
                                        <input type="text" class="text-input" id="bgColorText" value="#ffffff" oninput="updateFromTextInput('bgColorPicker', this.value, updateBackgroundColor)">
                                    </div>
                                    <p class="setting-description">Main page background</p>
                                </div>
                                <div class="setting-group">
                                    <label class="setting-label">Card Background</label>
                                    <div class="setting-control">
                                        <input type="color" class="color-input" id="surfaceColorPicker" value="#f8fafc" onchange="updateSurfaceColor(this.value)">
                                        <input type="text" class="text-input" id="surfaceColorText" value="#f8fafc" oninput="updateFromTextInput('surfaceColorPicker', this.value, updateSurfaceColor)">
                                    </div>
                                    <p class="setting-description">Background for cards and components</p>
                                </div>
                            </div>

                            <div class="section">
                                <h4>Text & Links</h4>
                                <div class="setting-group">
                                    <label class="setting-label">Text Color</label>
                                    <div class="setting-control">
                                        <input type="color" class="color-input" id="textColorPicker" value="#1e293b" onchange="updateTextColor(this.value)">
                                        <input type="text" class="text-input" id="textColorText" value="#1e293b" oninput="updateFromTextInput('textColorPicker', this.value, updateTextColor)">
                                    </div>
                                    <p class="setting-description">Primary text color for content</p>
                                </div>
                                <div class="setting-group">
                                    <label class="setting-label">Link Color</label>
                                    <div class="setting-control">
                                        <input type="color" class="color-input" id="linkColorPicker" value="#3b82f6" onchange="updateLinkColor(this.value)">
                                        <input type="text" class="text-input" id="linkColorText" value="#3b82f6" oninput="updateFromTextInput('linkColorPicker', this.value, updateLinkColor)">
                                    </div>
                                    <p class="setting-description">Color for text links (typically matches primary)</p>
                                </div>
                                <div class="setting-group">
                                    <label class="setting-label">Link Hover Color</label>
                                    <div class="setting-control">
                                        <input type="color" class="color-input" id="linkHoverPicker" value="#2563eb" onchange="updateLinkHoverColor(this.value)">
                                        <input type="text" class="text-input" id="linkHoverText" value="#2563eb" oninput="updateFromTextInput('linkHoverPicker', this.value, updateLinkHoverColor)">
                                    </div>
                                    <p class="setting-description">Link color on hover (darker than link color)</p>
                                </div>
                            </div>


                        </div>

                        <!-- Typography Tab -->
                        <div class="tab-pane">
                            <h3 class="section-title">Typography Settings</h3>
                            <p class="section-description">Customize fonts, sizes, and text styling</p>

                            <div class="section">
                                <h4>Font Family</h4>
                                <div class="setting-group">
                                    <label class="setting-label">Body Font</label>
                                    <select class="select-input" onchange="updateBodyFont(this.value)">
                                        <option value="system-ui, -apple-system, sans-serif">System Default</option>
                                        <option value="'Inter', system-ui, sans-serif" selected>Inter</option>
                                        <option value="'Roboto', sans-serif">Roboto</option>
                                        <option value="'Open Sans', sans-serif">Open Sans</option>
                                        <option value="'Lato', sans-serif">Lato</option>
                                        <option value="'Poppins', sans-serif">Poppins</option>
                                        <option value="'Montserrat', sans-serif">Montserrat</option>
                                    </select>
                                    <p class="setting-description">Main font for body text and UI</p>
                                </div>
                                <div class="setting-group">
                                    <label class="setting-label">Heading Font</label>
                                    <select class="select-input" onchange="updateHeadingFont(this.value)">
                                        <option value="inherit" selected>Same as body</option>
                                        <option value="'Playfair Display', serif">Playfair Display</option>
                                        <option value="'Merriweather', serif">Merriweather</option>
                                        <option value="'Lora', serif">Lora</option>
                                        <option value="'Raleway', sans-serif">Raleway</option>
                                        <option value="'Oswald', sans-serif">Oswald</option>
                                    </select>
                                    <p class="setting-description">Font for headings (H1-H6)</p>
                                </div>
                            </div>

                            <div class="section">
                                <h4>Font Sizing</h4>
                                <div class="setting-group">
                                    <label class="setting-label">Base Font Size</label>
                                    <div class="setting-control">
                                        <input type="range" class="range-input" min="14" max="18" value="16" onchange="updateBaseFontSize(this.value)">
                                        <span class="range-value" id="baseFontSize">16px</span>
                                    </div>
                                    <p class="setting-description">Base size for all text (affects entire scale)</p>
                                </div>
                                <div class="setting-group">
                                    <label class="setting-label">Heading Scale</label>
                                    <div class="setting-control">
                                        <input type="range" class="range-input" min="1.15" max="1.5" step="0.05" value="1.25" onchange="updateHeadingScale(this.value)">
                                        <span class="range-value" id="headingScale">1.25×</span>
                                    </div>
                                    <p class="setting-description">Size multiplier between heading levels</p>
                                </div>
                            </div>
                        </div>

                        <!-- Spacing Tab -->
                        <div class="tab-pane">
                            <h3 class="section-title">Spacing & Layout</h3>
                            <p class="section-description">Control spacing scale and container width</p>

                            <div class="section">
                                <h4>Spacing Scale</h4>
                                <div class="setting-group">
                                    <label class="setting-label">Base Spacing Unit</label>
                                    <div class="setting-control">
                                        <input type="range" class="range-input" min="4" max="12" value="8" onchange="updateValue('baseUnit', this.value)">
                                        <span class="range-value" id="baseUnit">8px</span>
                                    </div>
                                    <p class="setting-description">Foundation unit for all spacing (padding, margins, gaps)</p>
                                </div>
                            </div>

                            <div class="section">
                                <h4>Container</h4>
                                <div class="setting-group">
                                    <label class="setting-label">Max Width</label>
                                    <div class="setting-control">
                                        <input type="range" class="range-input" min="960" max="1440" step="40" value="1200" onchange="updateValue('containerWidth', this.value)">
                                        <span class="range-value" id="containerWidth">1200px</span>
                                    </div>
                                    <p class="setting-description">Maximum content width (centered on page)</p>
                                </div>
                            </div>
                        </div>

                        <!-- Effects Tab -->
                        <div class="tab-pane">
                            <h3 class="section-title">Visual Effects</h3>
                            <p class="section-description">Control visual styling and polish</p>

                            <div class="section">
                                <h4>Borders</h4>
                                <div class="setting-group">
                                    <label class="setting-label">Corner Radius</label>
                                    <select class="select-input" onchange="updateBorderRadius(this.value)">
                                        <option value="0">Sharp (0px)</option>
                                        <option value="4px">Small (4px)</option>
                                        <option value="6px">Medium (6px)</option>
                                        <option value="8px" selected>Default (8px)</option>
                                        <option value="12px">Large (12px)</option>
                                        <option value="16px">Extra Large (16px)</option>
                                    </select>
                                    <p class="setting-description">Roundness of cards, buttons, and components</p>
                                </div>
                            </div>

                            <div class="section">
                                <h4>Shadows</h4>
                                <div class="setting-group">
                                    <label class="setting-label">Elevation Intensity</label>
                                    <select class="select-input" onchange="updateShadow(this.value)">
                                        <option value="none">None (Flat)</option>
                                        <option value="subtle" selected>Subtle</option>
                                        <option value="medium">Medium</option>
                                        <option value="strong">Strong</option>
                                    </select>
                                    <p class="setting-description">Depth and shadow for elevated elements</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="modal-footer">
                <div class="footer-left">
                    <button class="btn btn-reset" onclick="resetSettings()">
                        ↺ Reset to Original
                    </button>
                </div>
                <div class="footer-right">
                    <button class="btn btn-cancel" onclick="closeModal()">Cancel</button>
                    <button class="btn btn-apply" onclick="applyChanges()">Apply Changes</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentTab = 1; // Start on Colors tab

        const shadowMap = {
            none: 'none',
            subtle: '0 1px 3px rgba(0, 0, 0, 0.1)',
            medium: '0 4px 6px rgba(0, 0, 0, 0.1)',
            strong: '0 10px 25px rgba(0, 0, 0, 0.15)'
        };



        // ============================================
        // UTILITY: Update Text Input When Color Picker Changes
        // ============================================
        function syncTextInput(colorInput) {
            const textInput = colorInput.nextElementSibling;
            if (textInput && textInput.classList.contains('text-input')) {
                textInput.value = colorInput.value;
            }
        }

        // ============================================
        // UTILITY: Update From Text Input
        // ============================================
        function updateFromTextInput(colorPickerId, value, updateFunction) {
            // Validate hex color format
            const hexRegex = /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/;
            
            if (hexRegex.test(value)) {
                // Update the color picker
                const colorPicker = document.getElementById(colorPickerId);
                if (colorPicker) {
                    colorPicker.value = value;
                }
                
                // Update the preview
                updateFunction(value);
            }
        }

        function switchTab(index) {
            const tabs = document.querySelectorAll('.tab');
            const panes = document.querySelectorAll('.tab-pane');
            
            tabs.forEach((tab, i) => {
                tab.classList.toggle('active', i === index);
            });
            
            panes.forEach((pane, i) => {
                pane.classList.toggle('active', i === index);
            });
            
            currentTab = index;
            
            // ROOT FIX: Re-check scroll after tab switch
            setTimeout(detectScrollableContent, 50);
        }

        // ============================================
        // COLOR UPDATES - PRIMARY COLORS
        // ============================================
        function updatePrimaryColor(color) {
            const primaryBtn = document.getElementById('primaryBtn');
            const previewLink = document.getElementById('previewLink');
            
            primaryBtn.style.background = color;
            primaryBtn.style.borderColor = color;
            previewLink.style.color = color;
            
            syncTextInput(event?.target);
        }

        function updatePrimaryTextColor(color) {
            const primaryBtn = document.getElementById('primaryBtn');
            primaryBtn.style.color = color;
            
            syncTextInput(event?.target);
        }

        function updateSecondaryColor(color) {
            const secondaryBtn = document.getElementById('secondaryBtn');
            secondaryBtn.style.background = color;
            secondaryBtn.style.borderColor = color;
            syncTextInput(event?.target);
        }

        // ============================================
        // COLOR UPDATES - BACKGROUND COLORS
        // ============================================
        function updateBackgroundColor(color) {
            document.getElementById('previewFrame').style.background = color;
            syncTextInput(event?.target);
        }

        function updateSurfaceColor(color) {
            document.getElementById('previewCard').style.background = color;
            syncTextInput(event?.target);
        }

        // ============================================
        // COLOR UPDATES - TEXT & LINKS
        // ============================================
        function updateTextColor(color) {
            document.getElementById('previewH1').style.color = color;
            document.getElementById('previewH2').style.color = color;
            document.getElementById('previewH3').style.color = color;
            document.getElementById('previewBody').style.color = color;
            document.getElementById('previewSmall').style.color = color;
            document.querySelector('.preview-card h4').style.color = color;
            document.querySelector('.preview-card p').style.color = color;
            syncTextInput(event?.target);
        }

        function updateLinkColor(color) {
            const previewLink = document.getElementById('previewLink');
            previewLink.style.color = color;
            syncTextInput(event?.target);
        }

        function updateLinkHoverColor(color) {
            // Store hover color as a data attribute for CSS to use
            const previewLink = document.getElementById('previewLink');
            previewLink.setAttribute('data-hover-color', color);
            
            // Add dynamic hover style
            const styleId = 'link-hover-style';
            let style = document.getElementById(styleId);
            if (!style) {
                style = document.createElement('style');
                style.id = styleId;
                document.head.appendChild(style);
            }
            style.textContent = `#previewLink:hover { color: ${color} !important; }`;
            
            syncTextInput(event?.target);
        }





        // ============================================
        // TYPOGRAPHY UPDATES
        // ============================================
        function updateBodyFont(font) {
            document.getElementById('previewFrame').style.fontFamily = font;
        }

        function updateHeadingFont(font) {
            const h1 = document.getElementById('previewH1');
            const h2 = document.getElementById('previewH2');
            const h3 = document.getElementById('previewH3');
            
            if (font === 'inherit') {
                h1.style.fontFamily = '';
                h2.style.fontFamily = '';
                h3.style.fontFamily = '';
            } else {
                h1.style.fontFamily = font;
                h2.style.fontFamily = font;
                h3.style.fontFamily = font;
            }
        }

        function updateBaseFontSize(size) {
            document.getElementById('previewBody').style.fontSize = size + 'px';
            document.getElementById('baseFontSize').textContent = size + 'px';
        }

        function updateHeadingScale(scale) {
            const baseSize = 40;
            document.getElementById('previewH1').style.fontSize = (baseSize * scale) + 'px';
            document.getElementById('previewH2').style.fontSize = (32 * scale) + 'px';
            document.getElementById('previewH3').style.fontSize = (24 * scale) + 'px';
            document.getElementById('headingScale').textContent = scale + '×';
        }





        // ============================================
        // EFFECTS UPDATES
        // ============================================
        function updateBorderRadius(radius) {
            // Apply to all rounded elements
            document.getElementById('previewFrame').style.borderRadius = radius;
            document.getElementById('previewCard').style.borderRadius = radius;
            document.getElementById('primaryBtn').style.borderRadius = radius;
            document.getElementById('secondaryBtn').style.borderRadius = radius;
            document.querySelectorAll('.status-item').forEach(el => {
                el.style.borderRadius = radius;
            });
        }

        function updateShadow(intensity) {
            const shadow = shadowMap[intensity];
            document.getElementById('previewFrame').style.boxShadow = shadow;
            document.getElementById('previewCard').style.boxShadow = shadow;
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function updateValue(id, value, suffix = 'px') {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = value + suffix;
            }
        }

        // ============================================
        // USER ACTIONS
        // ============================================
        function resetSettings() {
            if (confirm('Reset all settings to default values? This will reload the page.')) {
                location.reload();
            }
        }

        function closeModal() {
            if (confirm('Close and discard unsaved changes?')) {
                // In production, this would close the modal
                // For preview, we just alert
                alert('Modal would close here (in production)');
            }
        }

        function applyChanges() {
            alert('✓ Changes applied successfully!\n\nIn production, this would save your theme settings.');
        }

        // ============================================
        // SCROLL DETECTION & VISUAL INDICATORS
        // ============================================
        function detectScrollableContent() {
            // Check tab content
            const tabContent = document.querySelector('.tab-content');
            if (tabContent) {
                const isScrollable = tabContent.scrollHeight > tabContent.clientHeight;
                if (isScrollable) {
                    tabContent.classList.add('has-scroll');
                } else {
                    tabContent.classList.remove('has-scroll');
                }
            }
            
            // Check preview section
            const previewSection = document.querySelector('.preview-section');
            if (previewSection) {
                const isScrollable = previewSection.scrollHeight > previewSection.clientHeight;
                if (isScrollable) {
                    previewSection.classList.add('has-scroll');
                } else {
                    previewSection.classList.remove('has-scroll');
                }
            }
        }

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('✓ Theme Customizer Preview Loaded');
            console.log('✓ All color update functions are event-driven');
            console.log('✓ No polling or race conditions');
            
            // ROOT FIX: Detect scrollable content on load
            detectScrollableContent();
            
            // ROOT FIX: Re-check on window resize
            window.addEventListener('resize', detectScrollableContent);
            
            // ROOT FIX: Re-check on tab switch
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // Use setTimeout to wait for tab switch animation
                    setTimeout(detectScrollableContent, 50);
                });
            });
            
            console.log('✓ Scroll detection initialized');
        })
    </script>
</body>
</html>
